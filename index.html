<!DOCTYPE html>
<html prefix="og: https://ogp.me/ns#">
    <head>
        <!--TODO: Add meta data and title-->
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

        <!--CSS-->
        <link rel="stylesheet" href="/css/styles.css">

        <!--TODO: Add scripting here-->
    </head>
    <body>
        <div class="top nav">
            <h4 id="links">
                <a href="/">Home</a>
            </h4>
        </div>

        <div id="ucard" class="userCard">
            <div class="colorCard">
                <p>
                    <img id="userPFP" class="pfp" src="https://git.eggsnham.com/favicon.png"> 
                    <a style="text-decoration: none;color: darkcyan;" id="userDisplayName"></a>
                </p>
            </div>
            <br>
            <h4 id="isDev"></h4>
        </div>

        <div id="main"></div>

        <script type="module">
            import { getCurrentUser } from "/js/users.js"
            import { loadNewPosts } from "/js/posts.js"

            getCurrentUser().then(user => {
                console.log(user)
                document.getElementById("userPFP").src = user.photoURL
                document.getElementById("userDisplayName").innerText = user.name
                document.getElementById("userDisplayName").href = `/user`
                if(user.data.officialDev) document.getElementById("isDev").innerText = "Official Developer"
                document.getElementById("links").innerHTML += `<span class="blank">--</span><a href="javascript:signOutUser()">Logout</a><a style="float:right;margin-right: 20px;" href="">Create post</a>`
            }).catch(err => {
                console.log("Not logged in!")

                document.getElementById("ucard").remove()
                document.getElementById("links").innerHTML += `<span class="blank">--</span><a href="/login">Login</a>`
            })

            loadNewPosts(document.getElementById("main")).then(() => {
                document.getElementById("main").innerHTML += "<br><br><div style='margin:0 auto;max-width:50%;text-align:center;'><a href='/posts/'>View All</a></div>"
            }).catch(err => document.getElementById("main").append(err))
        </script>
    </body>
</html>